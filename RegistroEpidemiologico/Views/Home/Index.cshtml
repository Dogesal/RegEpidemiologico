@{
    var usuarioAutenticado = Context.Session.GetString("UsuarioAutenticado");
    var nombreUsuario = Context.Session.GetString("NombreUsuario");
}
@{
    ViewBag.Title = "Index";
}
@if (usuarioAutenticado == null || nombreUsuario == null)
{

    <script>window.location.href = `/Usuario`;</script>
}

<div class="container text-center mt-5">
    <h1 class="display-4" id="nombreUsuario">¡Bienvenido! </h1>
    <div id="greeting" class="lead"></div>
    <p class="mt-3">Estamos encantados de tenerte aquí. ¡Explora nuestros registros!</p>
    @Html.ActionLink("Ver Registros", "Index", "Paciente", new { area = "" }, new { @class = "btn btn-primary btn-lg mt-4" })
</div>
<div id="image-container">
    <!-- La imagen será insertada aquí -->
    <p>Cargando imagen...</p>
</div>

<script>
    // Usar fetch para obtener la imagen
    fetch('/Imagen/MostrarImagen/')
   .then(response => response.json())
   .then(data => {
       if (data.image) {
           // Crear un elemento <img> para mostrar la imagen
           const imgElement = document.createElement('img');
           imgElement.src = `data:image/jpeg;base64,${data.image}`; // Usar la imagen Base64
           imgElement.alt = "Imagen del paciente";
           imgElement.style.maxWidth = '100%'; // Ajustar el tamaño si es necesario

           // Insertar la imagen en el div
           const container = document.getElementById('image-container');
           container.innerHTML = ''; // Limpiar el mensaje "Cargando imagen..."
           container.appendChild(imgElement); // Agregar la imagen al contenedor
       } else {
           // Si no hay imagen, mostrar un mensaje
           document.getElementById('image-container').innerHTML = '<p>No se encontró la imagen.</p>';
       }
   })
   .catch(error => {
       console.error('Error al obtener la imagen:', error);
       document.getElementById('image-container').innerHTML = '<p>Hubo un error al cargar la imagen.</p>';
   });

</script>

<script>
    function getGreeting() {
        const hours = new Date().getHours();
        let greeting;
        let bgColor; // Variable to store the background color

        if (hours < 12) {
            greeting = "¡Buenos días!";
            bgColor = "#FFF9C4"; // Light yellow for morning
        } else if (hours < 18) {
            greeting = "¡Buenas tardes!";
            bgColor = "#BBDEFB"; // Light blue for afternoon
        } else {
            greeting = "¡Buenas noches!";
            bgColor = "#455A64"; // Dark grayish-blue for evening
        }

        document.getElementById("greeting").textContent = greeting;
        document.body.style.backgroundColor = bgColor;
        document.body.style.color = hours >= 18 ? "#ffffff" : "#000000";

    }


    window.onload = getGreeting;
</script>